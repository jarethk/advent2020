Part 1 - this is a double-sided jigsaw puzzle.  For every piece, we want to pre-calculate the edges for every rotation and flip, a total of 8 options.  We can shortcut this first part, looking only for the corner pieces which would line up with only 2 other pieces each.

Part 2 - We need now to get the whole picture.  Previously I was just doing the edges, so now have to deal with the full piece, or more accurately the middle section which excludes the edges.  For some reason I struggled with algorithm to rotate and flip the full frame, but got it right after a couple of tries.  From there, I almost tripped up on what they were looking for at the end, at first thinking they just wanted the count of matches, but then realized they wanted how many # were left after removing the serpents, and that we had to rotate/flip the combined image.  So more rotate/flip logic, resulting in another 8 images.  Treat the serpent like a regex, and see if we have 3 rows with the regex patterns starting at the same point, and count the number of matches in whatever rotation we hit first.  Multipley that count with the count of # in the serpent, and then subtract that from the total number of # in the full image.  And it finally worked.